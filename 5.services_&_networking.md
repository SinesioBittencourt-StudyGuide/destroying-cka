# Services & Networking

## 1. Understand host networking configuration on the cluster nodes

### Understanding Cluster Networking

Kubernetes relies on the Container Network Interface, CNI, Project to comply with the following requirements:

- All containers must communicate with each without NAT.

- Nodes can communicate with containers without NAT.

A container’s IP address is the same it sees itself as the outside the container.
Pods themselves are ephemeral
Local disk state, node scheduling, and IP addresses will all be replaced regularly during a pod’s life cycle.

A pod has a unique IP address, which is shared by all containers in the pod. The primary motivation behind giving every pod an IP address is to remove constraints around port numbers.
Kubernetes chose the IP per pod model to be more comfortable for developers to adopt and be easier to run third party workloads. Unfortunately for us, allocating and routing an IP address for every pod adds substantial complexity to a Kubernetes cluster.

The Kubernetes Network Is Default-OpenBy default, Kubernetes will allow any traffic to or from any pod.This passive connectivity means, among other things,that any pod in a cluster can connect to any other pod in that same cluster.That can easily lead to abuse,especially if services do not use authentication or if an attacker obtains credentials.

When explicitly creating a pod, it is possible to specify the IP address. StatefulSets are a built-in workloadtype intended for workloads such as databases, which maintain a pod identity concept and give a new pod the same nameand IP address as the pod it replaces.

Every Kubernetes Node runs a component called the kubelet, which manages pods on the node. The networking functionality in the kubelet comes from API interactions with a CNI plugin on the node.

The CNI plugin is what manages pod IP addresses and individual container network provisioning.

Kubernetes does not ship with a default CNI plugin, which means that in a standard installation of Kubernetes, pods cannot use the network.

### Node and Pod Network Layout

- Group of IP addresses for Pods
- Nodes and Pods must have L3 connectivity in the IP Address space.
- There are broadly three approaches, with many variations, to structuring a cluster’s network: isolated, flat, and island networks.

#### Isolated Networks

- Nodes are routable on the broader network.
- Pods cannot reach other pods(or any other hosts) outside the cluster.
- Multiple clusters can use the same IP Address space.
- Secure cluster option, isolated cluster.

#### Flat Networks

- All pods have an IP address that is routable from the broader network
- Pods can connect directly to arbitrary hosts in the network.
- Any host on the network is reachable to and from any pod.

#### Island Networks

- Island cluster networks are, at a high level, a combination of isolated and flat networks.
- Traffic to and from pods must pass through some form of proxy, as the pod’s IP address is not reachable externally
- In other words, packets appear to be “from” the node, rather than the pod.

### Pod Readiness and Probes

kubelet dictates Pod readiness with a user-specified readiness probe.
kubelet can also perform two types of health checks for individual containers in a pod: liveliness probes and readiness probes

References:

[Networking](https://kubernetes.io/docs/concepts/cluster-administration/networking/)

## 2. Understand connectivity between Pods

References:

[Pod Networking](https://kubernetes.io/docs/concepts/workloads/pods/#pod-networking)

## 3. Understand ClusterIP, NodePort, LoadBalancer service types and endpoints

References:

[Service Resource](https://kubernetes.io/docs/concepts/services-networking/service/#service-resource)

## 4. Know how to use Ingress controllers and Ingress resources

References:

[Ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/)
[Ingress Controllers](https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/)

## 5. Know how to configure and use CoreDNS

References:

[Using CoreDNS for Service Discovery](https://kubernetes.io/docs/tasks/administer-cluster/coredns/)

## 6. Choose an appropriate container network interface plugin

References:

[Network Plugins](https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/)